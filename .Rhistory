slope(TOTAL_SSB$ssbssbmsy_tc[1,]),
slope(ssbvssb$dlm.geomean),
slope(TOTAL_SSB_APRX$ssbssbmsy[1,]),
slope(TOTAL_SSB_APRX$ssbssbmsy_w[1,]),
slope(TOTAL_SSB_APRX$ssbssbmsy_med[1,]),
slope(TOTAL_SSB_APRX$ssbssbmsy_tc[1,]),
slope(ssbvssbaprx$dlm.geomean))
par(mfrow=c(1,2),xpd=FALSE,mar=c(2,2,2,2),oma=c(2,2,2,2),cex.axis=0.8)
hist(TOTAL_SSB$currentSSBSSBMSY[TOTAL_SSB$currentSSBSSBMSY<=2],xlim=c(0,2),breaks=25,main='',freq=FALSE,ylim=c(0,1.2),col=adjustcolor(cols[2],alpha.f=0.5),border=FALSE)
hist(TOTAL_SSB_APRX$currentSSBSSBMSY[TOTAL_SSB$currentSSBSSBMSY<=2],xlim=c(0,2),breaks=25,main='',freq=FALSE,ylim=c(0,1.2),col=adjustcolor(cols[1],alpha.f=0.5),border=FALSE,add=TRUE)
mtext(side=1,expression(italic('SSB/SSB'['MSY'])),line=2.5)
mtext(side=2,expression('Frequency Density'),line=2.5)
abline(v=1,lwd=1,lty=1,col='red')
abline(v=mean(status_ssb))
abline(v=mean(status_ssb)+2*c(-sd(status_ssb),sd(status_ssb))/sqrt(length(status_ssb)),lty=2)
hist(TOTAL_SSB$ssbssbmsy_trends,breaks=25,main='',freq=FALSE,ylim=c(0,15),border=FALSE,xlim=c(-0.2,0.2))
mtext(side=1,expression(italic('Trend in SSB/SSB'['MSY'])),line=2.5)
abline(v=0,lwd=1,lty=1,col='red')
abline(v=mean(status_slope_ssb))
abline(v=mean(status_slope_ssb)+2*c(-sd(status_slope_ssb),sd(status_slope_ssb))/sqrt(length(status_slope_ssb)),lty=2)
X <- data.frame(TOTAL_B$bbmsy[1,],TOTAL_B_APRX$bbmsy[1,],
TOTAL_B$bbmsy_tc[1,],TOTAL_B_APRX$bbmsy_tc[1,],
TOTAL_B$bbmsy_med[1,],TOTAL_B_APRX$bbmsy_med[1,],
TOTAL_B$bbmsy_w[1,],TOTAL_B_APRX$bbmsy_w[1,],
bvb$dlm.geomean[1:n],bvbaprx$dlm.geomean[1:n])
Xex <- data.frame(TOTAL_B$uumsy[1,],
TOTAL_B$uumsy_tc[1,],
TOTAL_B$uumsy_med[1,],
TOTAL_B$uumsy_w[1,],
uvu$dlm.geomean[1:n])
col <- adjustcolor('black',alpha.f=0.2)
par(mfrow=c(1,2),mar=c(2,2,2,2),oma=c(2,2,2,2),xpd=FALSE,cex.axis=0.8)
matplot(yrs,X,type='l',col=col,lty=1,ylim=c(0.8,2))
mtext(side=2,expression('B/B'['MSY']),line=2.5)
abline(h=1.0,lty=2)
lines(yrs,rowMeans(X),lwd=2,col='red')
lines(yrs,rowMeans(X)+2*apply(X,1,sd)/sqrt(10),lwd=1,lty=2,col='red')
lines(yrs,rowMeans(X)-2*apply(X,1,sd)/sqrt(10),lwd=1,lty=2,col='red')
matplot(yrs,Xex,type='l',col=col,lty=1,ylim=c(0.8,2))
mtext(side=2,expression('U/U'['MSY']),line=2.5)
abline(h=1.0,lty=2)
lines(yrs,rowMeans(Xex),lwd=2,col='red')
lines(yrs,rowMeans(Xex)+2*apply(Xex,1,sd)/sqrt(5),lwd=1,lty=2,col='red')
lines(yrs,rowMeans(Xex)-2*apply(Xex,1,sd)/sqrt(5),lwd=1,lty=2,col='red')
par(mfrow=c(1,1))
plot(yrs,TOTAL_B$proportion[yrs],type='l',ylim=c(0.1,0.8),xlab='',ylab='')
lines(yrs,TOTAL_B_APRX$proportion[yrs],type='l',lty=2)
lines(yrs,TOTAL_B$uumsy_proportion[yrs],type='l',col='red')
abline(h=0.5,lty=1)
legend('bottomright',legend=c(expression(italic('p(B<B'['MSY']*')')),
expression(italic('p(B<B'['MSY']*' historical)')),
expression(italic('p(SSB<SSB'['MSY']*')')),
expression(italic('p(SSB<SSB'['MSY']*' historical)')),
expression(italic('p(U<U'['MSY']*')'))),bty='n',
lty=c(1,2,1,2,1),col=c('black','black','blue','blue','red'))
mtext(side=2,'Proportion of Stocks',line=2.5)
plot(1950:yrs[n],TOTAL_B$proportion[1950:yrs[n]],type='l',ylim=c(0.1,1.0),xlab='',ylab='')
lines(1950:yrs[n],TOTAL_B_APRX$proportion[1950:yrs[n]],type='l',lty=2)
lines(1950:yrs[n],TOTAL_B$uumsy_proportion[1950:yrs[n]],type='l',col='red')
abline(h=0.5,lty=1)
legend('topright',legend=c(expression(italic('p(B<B'['MSY']*')')),
expression(italic('p(B<B'['MSY']*' historical)')),
#expression(italic('p(SSB<SSB'['MSY']*')')),
#expression(italic('p(SSB<SSB'['MSY']*' historical)')),
expression(italic('p(U<U'['MSY']*')'))),bty='n',
lty=c(1,2,1,2,1),col=c('black','black','red'))#blue','blue','red'))
mtext(side=2,'Proportion of Stocks',line=2.5)
rm(list=ls())
library(RColorBrewer)
library(Cairo)
setwd('~/dropbox/working/fisheries_uncertainty/github_public')
source('weight.func.r')
d      <- read.csv('data/RAMLDB v4.491 (assessment data only)_timeseries_values_views.csv',stringsAsFactors=FALSE)
stocks <- unique(d$stockid)
yrs <- 1980:2016
n <- length(yrs)
tc=msy  <- rep(NA,length(stocks))
for(i in 1:length(stocks)){
d_tmp <- d[d$stockid==stocks[i],]
TC        <- d_tmp$TCbest
TCMSY     <- d_tmp$CdivMSY
tc[i]     <- mean(TC,na.rm=TRUE)
msy[i]    <- mean(TC/TCMSY,na.rm=TRUE)
}
tc[tc=='NaN']=NA
msy[msy=='NaN'|msy=="Inf"]=NA
source('aggregate_bbmsy_comparison.r')
source('aggregate_ssbmsy_comparison.r')
source('aggregate_uumsy_comparison.r')
BvB         <- read.csv('data/BvBstocks.csv')
bvb         <- BvB[BvB$year%in%yrs,]
BvBaprx     <- read.csv('data/BvBstocks_aprx.csv')
bvbaprx     <- BvBaprx[BvBaprx$year%in%yrs,]
UvU         <- read.csv('data/UvUstocks.csv')
uvu         <- UvU[UvU$year%in%yrs,]
SSBvSSB     <- read.csv('data/SSBvSSB.csv')
ssbvssb     <- SSBvSSB[SSBvSSB$year%in%yrs,]
SSBvSSBaprx <- read.csv('data/SSBvSSB_aprx.csv')
ssbvssbaprx <- SSBvSSBaprx[SSBvSSBaprx$year%in%yrs,]
alpha  <- 0.7
lincol <- 'grey'
rects <- function(alpha){
rect(xleft=0,xright=1,ybottom=1,ytop=2,col=adjustcolor('red',alpha.f=alpha),border=NA)
rect(xleft=1,xright=2,ybottom=1,ytop=2,col=adjustcolor('yellow',alpha.f=alpha),border=NA)
rect(xleft=0,xright=1,ybottom=0,ytop=1,col=adjustcolor('yellow',alpha.f=alpha),border=NA)
rect(xleft=1,xright=2,ybottom=0,ytop=1,col=adjustcolor('green',alpha.f=alpha),border=NA)
}
CIs <- function(muX,sdX,muY,sdY){
lines(x=muX-sdX,y=muY-sdY,lty=2)
lines(x=muX+sdX,y=muY+sdY,lty=2)
}
segs <- function(muX,sdX,muY,sdY){
points(muX[1],muY[1],pch=8)
segments(x0=muX[n]-2*sdX[n],x1=muX[n]+2*sdX[n],y0=muY[n],         y1=muY[n],lty=1,lwd=2)
segments(x0=muX[n],      x1=muX[n],         y0=muY[n]+2*sdY[n],y1=muY[n]-2*sdY[n],lty=1,lwd=2)
}
segg <- function(){
segments(x0=0,x1=2,y0=1,y1=1,lty=2)
segments(x0=1,x1=1,y0=0,y1=2,lty=2)
}
labs <- function(){
mtext(side=2,line=2.5,expression('U/U'['MSY']))
mtext(side=1,line=2.5,expression('B/B'['MSY']))
}
par(mfrow=c(2,5),mar=c(2,1,4,1),oma=c(4,4,3,3),xpd=TRUE)
plot(TOTAL_B$uumsy[1,],TOTAL_B$bbmsy[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,bty='n',type='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B$bbmsy[1,],TOTAL_B$uumsy[1,],col=lincol)
segs(TOTAL_B$bbmsy[1,],TOTAL_B$bbmsy[2,],TOTAL_B$uumsy[1,],TOTAL_B$uumsy[2,])
mtext('Unweighted Mean',adj=1,cex=1); mtext('a',adj=0.05,line=0)
plot(TOTAL_B$uumsy_w[1,],TOTAL_B$bbmsy_w[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 	segg()
lines(TOTAL_B$bbmsy_w[1,],TOTAL_B$uumsy_w[1,],col=lincol)
segs(TOTAL_B$bbmsy_w[1,],TOTAL_B$bbmsy_w[2,],TOTAL_B$uumsy_w[1,],TOTAL_B$uumsy_w[2,])
mtext('Weighted Mean',adj=1,cex=1); mtext('b',adj=0.05,line=0)
plot(TOTAL_B$uumsy_med[1,],TOTAL_B$bbmsy_med[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_B$bbmsy_med[1,],TOTAL_B$uumsy_med[1,],col=lincol)
segs(TOTAL_B$bbmsy_med[1,],TOTAL_B$bbmsy_med[2,],TOTAL_B$uumsy_med[1,],TOTAL_B$uumsy_med[2,])
mtext('Median',adj=1,cex=1); mtext('c',adj=0.05,line=0)
plot(TOTAL_B$uumsy_tc[1,],TOTAL_B$bbmsy_tc[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_B$bbmsy_tc[1,],TOTAL_B$uumsy_tc[1,],col=lincol)
segs(TOTAL_B$bbmsy_tc[1,],TOTAL_B$bbmsy_tc[2,],TOTAL_B$uumsy_tc[1,],TOTAL_B$uumsy_tc[2,])
mtext('Mean Catch',adj=1,cex=1); mtext('d',adj=0.05,line=0)
plot(uvu$dlm.geomean,bvb$dlm.geomean[1:n],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(bvb$dlm.geomean,uvu$dlm.geomean,col=lincol)
segs(bvb$dlm.geomean,bvb$dlm.geomean-bvb$dlm.lower,uvu$dlm.geomean,uvu$dlm.geomean-uvu$dlm.lower)
mtext('State Space Model',adj=1,cex=1); mtext('e',adj=0.05,line=0)
plot(TOTAL_B$uumsy[1,],TOTAL_B_APRX$bbmsy[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,bty='n',type='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B_APRX$bbmsy[1,],TOTAL_B$uumsy[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy[1,],TOTAL_B_APRX$bbmsy[2,],TOTAL_B$uumsy[1,],TOTAL_B$uumsy[2,])
mtext('Unweighted Mean',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('f',adj=0.05,line=0)
plot(TOTAL_B$uumsy[1,],TOTAL_B_APRX$bbmsy_w[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B_APRX$bbmsy_w[1,],TOTAL_B$uumsy_w[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy_w[1,],TOTAL_B_APRX$bbmsy_w[2,],TOTAL_B$uumsy_w[1,],TOTAL_B$uumsy_w[2,])
mtext('Weighted Mean',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('g',adj=0.05,line=0)
plot(TOTAL_B$uumsy_med[1,],TOTAL_B_APRX$bbmsy_med[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B_APRX$bbmsy_med[1,],TOTAL_B$uumsy_med[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy_med[1,],TOTAL_B_APRX$bbmsy_med[2,],TOTAL_B$uumsy_med[1,],TOTAL_B$uumsy_med[2,])
mtext('Median',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('h',adj=0.05,line=0)
plot(TOTAL_B$uumsy_tc[1,],TOTAL_B_APRX$bbmsy_tc[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_B_APRX$bbmsy_tc[1,],TOTAL_B$uumsy_tc[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy_tc[1,],TOTAL_B_APRX$bbmsy_tc[2,],TOTAL_B$uumsy_tc[1,],TOTAL_B$uumsy_tc[2,])
mtext('Mean Catch',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('i',adj=0.05,line=0)
plot(uvu$dlm.geomean,bvbaprx$dlm.geomean[1:n],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha)
lines(bvbaprx$dlm.geomean[1:n],uvu$dlm.geomean,col='dark grey')
segg()
segs(bvbaprx$dlm.geomean,bvbaprx$dlm.geomean-bvbaprx$dlm.lower,uvu$dlm.geomean,uvu$dlm.geomean-uvu$dlm.lower)
mtext('State Space Model',adj=1,cex=1,line=1);mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); 		mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('j',adj=0.05,line=0)
mtext(side=2,outer=TRUE,expression('U/U'['MSY']),cex=1.3,line=1.5)
mtext(side=1,outer=TRUE,expression('B/B'['MSY']),cex=1.3,line=1.5)
par(mfrow=c(2,5),mar=c(2,1,4,1),oma=c(4,4,3,3),xpd=TRUE)
plot(TOTAL_B$uumsy[1,],TOTAL_SSB$ssbssbmsy[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,bty='n',type='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_SSB$ssbssbmsy[1,],TOTAL_B$uumsy[1,],col=lincol)
segs(TOTAL_SSB$ssbssbmsy[1,],TOTAL_SSB$ssbssbmsy[2,],TOTAL_B$uumsy[1,],TOTAL_B$uumsy[2,])
mtext('Unweighted Mean',adj=1,cex=1); mtext('a',adj=0.05,line=0)
plot(TOTAL_B$uumsy_w[1,],TOTAL_SSB$ssbssbmsy_w[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 	segg()
lines(TOTAL_SSB$ssbssbmsy_w[1,],TOTAL_B$uumsy_w[1,],col=lincol)
segs(TOTAL_SSB$ssbssbmsy_w[1,],TOTAL_SSB$ssbssbmsy_w[2,],TOTAL_B$uumsy_w[1,],TOTAL_B$uumsy_w[2,])
mtext('Weighted Mean',adj=1,cex=1); mtext('b',adj=0.05,line=0)
plot(TOTAL_B$uumsy_med[1,],TOTAL_SSB$ssbssbmsy_med[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_SSB$ssbssbmsy_med[1,],TOTAL_B$uumsy_med[1,],col=lincol)
segs(TOTAL_SSB$ssbssbmsy_med[1,],TOTAL_SSB$ssbssbmsy_med[2,],TOTAL_B$uumsy_med[1,],TOTAL_B$uumsy_med[2,])
mtext('Median',adj=1,cex=1); mtext('c',adj=0.05,line=0)
plot(TOTAL_B$uumsy_tc[1,],TOTAL_SSB$ssbssbmsy_tc[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_SSB$ssbssbmsy_tc[1,],TOTAL_B$uumsy_tc[1,],col=lincol)
segs(TOTAL_SSB$ssbssbmsy_tc[1,],TOTAL_SSB$ssbssbmsy_tc[2,],TOTAL_B$uumsy_tc[1,],TOTAL_B$uumsy_tc[2,])
mtext('Mean Catch',adj=1,cex=1); mtext('d',adj=0.05,line=0)
plot(uvu$dlm.geomean,ssbvssb$dlm.geomean,ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(ssbvssb$dlm.geomean[1:n],uvu$dlm.geomean,col=lincol)
segs(ssbvssb$dlm.geomean,ssbvssb$dlm.geomean-ssbvssb$dlm.lower,uvu$dlm.geomean,uvu$dlm.geomean-uvu$dlm.lower)
mtext('State Space Model',adj=1,cex=1); mtext('e',adj=0.05,line=0)
plot(TOTAL_B$uumsy[1,],TOTAL_SSB_APRX$SSbSSbmsy[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,bty='n',type='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_SSB_APRX$ssbssbmsy[1,],TOTAL_B$uumsy[1,],col='dark grey')
segs(TOTAL_SSB_APRX$ssbssbmsy[1,],TOTAL_SSB_APRX$ssbssbmsy[2,],TOTAL_B$uumsy[1,],TOTAL_B$uumsy[2,])
mtext('Unweighted Mean',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('f',adj=0.05,line=0)
plot(TOTAL_B$uumsy[1,],TOTAL_SSB_APRX$ssbssbmsy_w[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_SSB_APRX$ssbssbmsy_w[1,],TOTAL_B$uumsy_w[1,],col='dark grey')
segs(TOTAL_SSB_APRX$ssbssbmsy_w[1,],TOTAL_SSB_APRX$ssbssbmsy_w[2,],TOTAL_B$uumsy_w[1,],TOTAL_B$uumsy_w[2,])
mtext('Weighted Mean',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('g',adj=0.05,line=0)
plot(TOTAL_B$uumsy_med[1,],TOTAL_SSB_APRX$ssbssbmsy_med[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_SSB_APRX$ssbssbmsy_med[1,],TOTAL_B$uumsy_med[1,],col='dark grey')
segs(TOTAL_SSB_APRX$ssbssbmsy_med[1,],TOTAL_SSB_APRX$ssbssbmsy_med[2,],TOTAL_B$uumsy_med[1,],TOTAL_B$uumsy_med[2,])
mtext('Median',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('h',adj=0.05,line=0)
plot(TOTAL_B$uumsy_tc[1,],TOTAL_SSB_APRX$ssbssbmsy_tc[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_SSB_APRX$ssbssbmsy_tc[1,],TOTAL_B$uumsy_tc[1,],col='dark grey')
segs(TOTAL_SSB_APRX$ssbssbmsy_tc[1,],TOTAL_SSB_APRX$ssbssbmsy_tc[2,],TOTAL_B$uumsy_tc[1,],TOTAL_B$uumsy_tc[2,])
mtext('Mean Catch',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('i',adj=0.05,line=0)
plot(uvu$dlm.geomean,ssbvssbaprx$dlm.geomean[1:n],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha)
lines(ssbvssbaprx$dlm.geomean[1:n],uvu$dlm.geomean,col='dark grey')
segg()
segs(ssbvssbaprx$dlm.geomean,ssbvssbaprx$dlm.geomean-ssbvssbaprx$dlm.lower,uvu$dlm.geomean,uvu$dlm.geomean-uvu$dlm.lower)
mtext('State Space Model',adj=1,cex=1,line=1);mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); 		mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('j',adj=0.05,line=0)
mtext(side=2,outer=TRUE,expression('U/U'['MSY']),cex=1.3,line=1.5)
mtext(side=1,outer=TRUE,expression('SSB/SSB'['MSY']),cex=1.3,line=1.5)
rm(list=ls())
library(RColorBrewer)
library(Cairo)
setwd('~/dropbox/working/fisheries_uncertainty/github_public')
source('weight.func.r')
d      <- read.csv('data/RAMLDB v4.491 (assessment data only)_timeseries_values_views.csv',stringsAsFactors=FALSE)
stocks <- unique(d$stockid)
yrs <- 1980:2016
n <- length(yrs)
tc <- rep(NA,length(stocks))
for(i in 1:length(stocks)){
d_tmp <- d[d$stockid==stocks[i],]
TC        <- d_tmp$TCbest
tc[i]     <- mean(TC,na.rm=TRUE)
}
tc <- rep(NA,length(stocks))
for(i in 1:length(stocks)){
d_tmp <- d[d$stockid==stocks[i],]
TC        <- d_tmp$TCbest
tc[i]     <- mean(TC,na.rm=TRUE)
}; tc[tc=='NaN']=NA
source('aggregate_bbmsy_comparison.r')
source('aggregate_ssbmsy_comparison.r')
source('aggregate_uumsy_comparison.r')
BvB         <- read.csv('data/BvBstocks.csv')
bvb         <- BvB[BvB$year%in%yrs,]
BvBaprx     <- read.csv('data/BvBstocks_aprx.csv')
bvbaprx     <- BvBaprx[BvBaprx$year%in%yrs,]
UvU         <- read.csv('data/UvUstocks.csv')
uvu         <- UvU[UvU$year%in%yrs,]
SSBvSSB     <- read.csv('data/SSBvSSB.csv')
ssbvssb     <- SSBvSSB[SSBvSSB$year%in%yrs,]
SSBvSSBaprx <- read.csv('data/SSBvSSB_aprx.csv')
ssbvssbaprx <- SSBvSSBaprx[SSBvSSBaprx$year%in%yrs,]
alpha  <- 0.7
lincol <- 'grey'
rects <- function(alpha){
rect(xleft=0,xright=1,ybottom=1,ytop=2,col=adjustcolor('red',alpha.f=alpha),border=NA)
rect(xleft=1,xright=2,ybottom=1,ytop=2,col=adjustcolor('yellow',alpha.f=alpha),border=NA)
rect(xleft=0,xright=1,ybottom=0,ytop=1,col=adjustcolor('yellow',alpha.f=alpha),border=NA)
rect(xleft=1,xright=2,ybottom=0,ytop=1,col=adjustcolor('green',alpha.f=alpha),border=NA)
}
CIs <- function(muX,sdX,muY,sdY){
lines(x=muX-sdX,y=muY-sdY,lty=2)
lines(x=muX+sdX,y=muY+sdY,lty=2)
}
segs <- function(muX,sdX,muY,sdY){
points(muX[1],muY[1],pch=8)
segments(x0=muX[n]-2*sdX[n],x1=muX[n]+2*sdX[n],y0=muY[n],         y1=muY[n],lty=1,lwd=2)
segments(x0=muX[n],      x1=muX[n],         y0=muY[n]+2*sdY[n],y1=muY[n]-2*sdY[n],lty=1,lwd=2)
}
segg <- function(){
segments(x0=0,x1=2,y0=1,y1=1,lty=2)
segments(x0=1,x1=1,y0=0,y1=2,lty=2)
}
labs <- function(){
mtext(side=2,line=2.5,expression('U/U'['MSY']))
mtext(side=1,line=2.5,expression('B/B'['MSY']))
}
###################################
## PLOTS ##########################
###################################
par(mfrow=c(2,5),mar=c(2,1,4,1),oma=c(4,4,3,3),xpd=TRUE)
plot(TOTAL_B$uumsy[1,],TOTAL_B$bbmsy[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,bty='n',type='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B$bbmsy[1,],TOTAL_B$uumsy[1,],col=lincol)
segs(TOTAL_B$bbmsy[1,],TOTAL_B$bbmsy[2,],TOTAL_B$uumsy[1,],TOTAL_B$uumsy[2,])
mtext('Unweighted Mean',adj=1,cex=1); mtext('a',adj=0.05,line=0)
plot(TOTAL_B$uumsy_w[1,],TOTAL_B$bbmsy_w[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 	segg()
lines(TOTAL_B$bbmsy_w[1,],TOTAL_B$uumsy_w[1,],col=lincol)
segs(TOTAL_B$bbmsy_w[1,],TOTAL_B$bbmsy_w[2,],TOTAL_B$uumsy_w[1,],TOTAL_B$uumsy_w[2,])
mtext('Weighted Mean',adj=1,cex=1); mtext('b',adj=0.05,line=0)
plot(TOTAL_B$uumsy_med[1,],TOTAL_B$bbmsy_med[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_B$bbmsy_med[1,],TOTAL_B$uumsy_med[1,],col=lincol)
segs(TOTAL_B$bbmsy_med[1,],TOTAL_B$bbmsy_med[2,],TOTAL_B$uumsy_med[1,],TOTAL_B$uumsy_med[2,])
mtext('Median',adj=1,cex=1); mtext('c',adj=0.05,line=0)
plot(TOTAL_B$uumsy_tc[1,],TOTAL_B$bbmsy_tc[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_B$bbmsy_tc[1,],TOTAL_B$uumsy_tc[1,],col=lincol)
segs(TOTAL_B$bbmsy_tc[1,],TOTAL_B$bbmsy_tc[2,],TOTAL_B$uumsy_tc[1,],TOTAL_B$uumsy_tc[2,])
mtext('Mean Catch',adj=1,cex=1); mtext('d',adj=0.05,line=0)
plot(uvu$dlm.geomean,bvb$dlm.geomean[1:n],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(bvb$dlm.geomean,uvu$dlm.geomean,col=lincol)
segs(bvb$dlm.geomean,bvb$dlm.geomean-bvb$dlm.lower,uvu$dlm.geomean,uvu$dlm.geomean-uvu$dlm.lower)
mtext('State Space Model',adj=1,cex=1); mtext('e',adj=0.05,line=0)
plot(TOTAL_B$uumsy[1,],TOTAL_B_APRX$bbmsy[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,bty='n',type='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B_APRX$bbmsy[1,],TOTAL_B$uumsy[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy[1,],TOTAL_B_APRX$bbmsy[2,],TOTAL_B$uumsy[1,],TOTAL_B$uumsy[2,])
mtext('Unweighted Mean',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('f',adj=0.05,line=0)
plot(TOTAL_B$uumsy[1,],TOTAL_B_APRX$bbmsy_w[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B_APRX$bbmsy_w[1,],TOTAL_B$uumsy_w[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy_w[1,],TOTAL_B_APRX$bbmsy_w[2,],TOTAL_B$uumsy_w[1,],TOTAL_B$uumsy_w[2,])
mtext('Weighted Mean',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('g',adj=0.05,line=0)
plot(TOTAL_B$uumsy_med[1,],TOTAL_B_APRX$bbmsy_med[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B_APRX$bbmsy_med[1,],TOTAL_B$uumsy_med[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy_med[1,],TOTAL_B_APRX$bbmsy_med[2,],TOTAL_B$uumsy_med[1,],TOTAL_B$uumsy_med[2,])
mtext('Median',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('h',adj=0.05,line=0)
plot(TOTAL_B$uumsy_tc[1,],TOTAL_B_APRX$bbmsy_tc[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_B_APRX$bbmsy_tc[1,],TOTAL_B$uumsy_tc[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy_tc[1,],TOTAL_B_APRX$bbmsy_tc[2,],TOTAL_B$uumsy_tc[1,],TOTAL_B$uumsy_tc[2,])
mtext('Mean Catch',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('i',adj=0.05,line=0)
plot(uvu$dlm.geomean,bvbaprx$dlm.geomean[1:n],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha)
lines(bvbaprx$dlm.geomean[1:n],uvu$dlm.geomean,col='dark grey')
segg()
segs(bvbaprx$dlm.geomean,bvbaprx$dlm.geomean-bvbaprx$dlm.lower,uvu$dlm.geomean,uvu$dlm.geomean-uvu$dlm.lower)
mtext('State Space Model',adj=1,cex=1,line=1);mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); 		mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('j',adj=0.05,line=0)
mtext(side=2,outer=TRUE,expression('U/U'['MSY']),cex=1.3,line=1.5)
mtext(side=1,outer=TRUE,expression('B/B'['MSY']),cex=1.3,line=1.5)
rm(list=ls())
library(RColorBrewer)
library(Cairo)
setwd('~/dropbox/working/fisheries_uncertainty/github_public')
source('weight.func.r')
d      <- read.csv('data/RAMLDB v4.491 (assessment data only)_timeseries_values_views.csv',stringsAsFactors=FALSE)
stocks <- unique(d$stockid)
yrs <- 1980:2016
n <- length(yrs)
tc <- rep(NA,length(stocks))
for(i in 1:length(stocks)){
d_tmp <- d[d$stockid==stocks[i],]
TC        <- d_tmp$TCbest
tc[i]     <- mean(TC,na.rm=TRUE)
}; tc[tc=='NaN']=NA
source('aggregate_bbmsy_comparison.r')
source('aggregate_ssbmsy_comparison.r')
source('aggregate_uumsy_comparison.r')
BvB         <- read.csv('data/BvBstocks.csv')
bvb         <- BvB[BvB$year%in%yrs,]
BvBaprx     <- read.csv('data/BvBstocks_aprx.csv')
bvbaprx     <- BvBaprx[BvBaprx$year%in%yrs,]
UvU         <- read.csv('data/UvUstocks.csv')
uvu         <- UvU[UvU$year%in%yrs,]
SSBvSSB     <- read.csv('data/SSBvSSB.csv')
ssbvssb     <- SSBvSSB[SSBvSSB$year%in%yrs,]
SSBvSSBaprx <- read.csv('data/SSBvSSB_aprx.csv')
ssbvssbaprx <- SSBvSSBaprx[SSBvSSBaprx$year%in%yrs,]
alpha  <- 0.7
lincol <- 'grey'
rects <- function(alpha){
rect(xleft=0,xright=1,ybottom=1,ytop=2,col=adjustcolor('red',alpha.f=alpha),border=NA)
rect(xleft=1,xright=2,ybottom=1,ytop=2,col=adjustcolor('yellow',alpha.f=alpha),border=NA)
rect(xleft=0,xright=1,ybottom=0,ytop=1,col=adjustcolor('yellow',alpha.f=alpha),border=NA)
rect(xleft=1,xright=2,ybottom=0,ytop=1,col=adjustcolor('green',alpha.f=alpha),border=NA)
}
CIs <- function(muX,sdX,muY,sdY){
lines(x=muX-sdX,y=muY-sdY,lty=2)
lines(x=muX+sdX,y=muY+sdY,lty=2)
}
segs <- function(muX,sdX,muY,sdY){
points(muX[1],muY[1],pch=8)
segments(x0=muX[n]-2*sdX[n],x1=muX[n]+2*sdX[n],y0=muY[n],         y1=muY[n],lty=1,lwd=2)
segments(x0=muX[n],      x1=muX[n],         y0=muY[n]+2*sdY[n],y1=muY[n]-2*sdY[n],lty=1,lwd=2)
}
segg <- function(){
segments(x0=0,x1=2,y0=1,y1=1,lty=2)
segments(x0=1,x1=1,y0=0,y1=2,lty=2)
}
labs <- function(){
mtext(side=2,line=2.5,expression('U/U'['MSY']))
mtext(side=1,line=2.5,expression('B/B'['MSY']))
}
###################################
## PLOTS ##########################
###################################
par(mfrow=c(2,5),mar=c(2,1,4,1),oma=c(4,4,3,3),xpd=TRUE)
plot(TOTAL_B$uumsy[1,],TOTAL_B$bbmsy[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,bty='n',type='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B$bbmsy[1,],TOTAL_B$uumsy[1,],col=lincol)
segs(TOTAL_B$bbmsy[1,],TOTAL_B$bbmsy[2,],TOTAL_B$uumsy[1,],TOTAL_B$uumsy[2,])
mtext('Unweighted Mean',adj=1,cex=1); mtext('a',adj=0.05,line=0)
plot(TOTAL_B$uumsy_w[1,],TOTAL_B$bbmsy_w[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 	segg()
lines(TOTAL_B$bbmsy_w[1,],TOTAL_B$uumsy_w[1,],col=lincol)
segs(TOTAL_B$bbmsy_w[1,],TOTAL_B$bbmsy_w[2,],TOTAL_B$uumsy_w[1,],TOTAL_B$uumsy_w[2,])
mtext('Weighted Mean',adj=1,cex=1); mtext('b',adj=0.05,line=0)
plot(TOTAL_B$uumsy_med[1,],TOTAL_B$bbmsy_med[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_B$bbmsy_med[1,],TOTAL_B$uumsy_med[1,],col=lincol)
segs(TOTAL_B$bbmsy_med[1,],TOTAL_B$bbmsy_med[2,],TOTAL_B$uumsy_med[1,],TOTAL_B$uumsy_med[2,])
mtext('Median',adj=1,cex=1); mtext('c',adj=0.05,line=0)
plot(TOTAL_B$uumsy_tc[1,],TOTAL_B$bbmsy_tc[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_B$bbmsy_tc[1,],TOTAL_B$uumsy_tc[1,],col=lincol)
segs(TOTAL_B$bbmsy_tc[1,],TOTAL_B$bbmsy_tc[2,],TOTAL_B$uumsy_tc[1,],TOTAL_B$uumsy_tc[2,])
mtext('Mean Catch',adj=1,cex=1); mtext('d',adj=0.05,line=0)
plot(uvu$dlm.geomean,bvb$dlm.geomean[1:n],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(bvb$dlm.geomean,uvu$dlm.geomean,col=lincol)
segs(bvb$dlm.geomean,bvb$dlm.geomean-bvb$dlm.lower,uvu$dlm.geomean,uvu$dlm.geomean-uvu$dlm.lower)
mtext('State Space Model',adj=1,cex=1); mtext('e',adj=0.05,line=0)
plot(TOTAL_B$uumsy[1,],TOTAL_B_APRX$bbmsy[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,bty='n',type='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B_APRX$bbmsy[1,],TOTAL_B$uumsy[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy[1,],TOTAL_B_APRX$bbmsy[2,],TOTAL_B$uumsy[1,],TOTAL_B$uumsy[2,])
mtext('Unweighted Mean',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('f',adj=0.05,line=0)
plot(TOTAL_B$uumsy[1,],TOTAL_B_APRX$bbmsy_w[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B_APRX$bbmsy_w[1,],TOTAL_B$uumsy_w[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy_w[1,],TOTAL_B_APRX$bbmsy_w[2,],TOTAL_B$uumsy_w[1,],TOTAL_B$uumsy_w[2,])
mtext('Weighted Mean',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('g',adj=0.05,line=0)
plot(TOTAL_B$uumsy_med[1,],TOTAL_B_APRX$bbmsy_med[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_B_APRX$bbmsy_med[1,],TOTAL_B$uumsy_med[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy_med[1,],TOTAL_B_APRX$bbmsy_med[2,],TOTAL_B$uumsy_med[1,],TOTAL_B$uumsy_med[2,])
mtext('Median',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('h',adj=0.05,line=0)
plot(TOTAL_B$uumsy_tc[1,],TOTAL_B_APRX$bbmsy_tc[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_B_APRX$bbmsy_tc[1,],TOTAL_B$uumsy_tc[1,],col='dark grey')
segs(TOTAL_B_APRX$bbmsy_tc[1,],TOTAL_B_APRX$bbmsy_tc[2,],TOTAL_B$uumsy_tc[1,],TOTAL_B$uumsy_tc[2,])
mtext('Mean Catch',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('i',adj=0.05,line=0)
plot(uvu$dlm.geomean,bvbaprx$dlm.geomean[1:n],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha)
lines(bvbaprx$dlm.geomean[1:n],uvu$dlm.geomean,col='dark grey')
segg()
segs(bvbaprx$dlm.geomean,bvbaprx$dlm.geomean-bvbaprx$dlm.lower,uvu$dlm.geomean,uvu$dlm.geomean-uvu$dlm.lower)
mtext('State Space Model',adj=1,cex=1,line=1);mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); 		mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('j',adj=0.05,line=0)
mtext(side=2,outer=TRUE,expression('U/U'['MSY']),cex=1.3,line=1.5)
mtext(side=1,outer=TRUE,expression('B/B'['MSY']),cex=1.3,line=1.5)
par(mfrow=c(2,5),mar=c(2,1,4,1),oma=c(4,4,3,3),xpd=TRUE)
plot(TOTAL_B$uumsy[1,],TOTAL_SSB$ssbssbmsy[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,bty='n',type='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_SSB$ssbssbmsy[1,],TOTAL_B$uumsy[1,],col=lincol)
segs(TOTAL_SSB$ssbssbmsy[1,],TOTAL_SSB$ssbssbmsy[2,],TOTAL_B$uumsy[1,],TOTAL_B$uumsy[2,])
mtext('Unweighted Mean',adj=1,cex=1); mtext('a',adj=0.05,line=0)
plot(TOTAL_B$uumsy_w[1,],TOTAL_SSB$ssbssbmsy_w[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 	segg()
lines(TOTAL_SSB$ssbssbmsy_w[1,],TOTAL_B$uumsy_w[1,],col=lincol)
segs(TOTAL_SSB$ssbssbmsy_w[1,],TOTAL_SSB$ssbssbmsy_w[2,],TOTAL_B$uumsy_w[1,],TOTAL_B$uumsy_w[2,])
mtext('Weighted Mean',adj=1,cex=1); mtext('b',adj=0.05,line=0)
plot(TOTAL_B$uumsy_med[1,],TOTAL_SSB$ssbssbmsy_med[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_SSB$ssbssbmsy_med[1,],TOTAL_B$uumsy_med[1,],col=lincol)
segs(TOTAL_SSB$ssbssbmsy_med[1,],TOTAL_SSB$ssbssbmsy_med[2,],TOTAL_B$uumsy_med[1,],TOTAL_B$uumsy_med[2,])
mtext('Median',adj=1,cex=1); mtext('c',adj=0.05,line=0)
plot(TOTAL_B$uumsy_tc[1,],TOTAL_SSB$ssbssbmsy_tc[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_SSB$ssbssbmsy_tc[1,],TOTAL_B$uumsy_tc[1,],col=lincol)
segs(TOTAL_SSB$ssbssbmsy_tc[1,],TOTAL_SSB$ssbssbmsy_tc[2,],TOTAL_B$uumsy_tc[1,],TOTAL_B$uumsy_tc[2,])
mtext('Mean Catch',adj=1,cex=1); mtext('d',adj=0.05,line=0)
plot(uvu$dlm.geomean,ssbvssb$dlm.geomean,ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(ssbvssb$dlm.geomean[1:n],uvu$dlm.geomean,col=lincol)
segs(ssbvssb$dlm.geomean,ssbvssb$dlm.geomean-ssbvssb$dlm.lower,uvu$dlm.geomean,uvu$dlm.geomean-uvu$dlm.lower)
mtext('State Space Model',adj=1,cex=1); mtext('e',adj=0.05,line=0)
plot(TOTAL_B$uumsy[1,],TOTAL_SSB_APRX$SSbSSbmsy[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,bty='n',type='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_SSB_APRX$ssbssbmsy[1,],TOTAL_B$uumsy[1,],col='dark grey')
segs(TOTAL_SSB_APRX$ssbssbmsy[1,],TOTAL_SSB_APRX$ssbssbmsy[2,],TOTAL_B$uumsy[1,],TOTAL_B$uumsy[2,])
mtext('Unweighted Mean',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('f',adj=0.05,line=0)
plot(TOTAL_B$uumsy[1,],TOTAL_SSB_APRX$ssbssbmsy_w[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_SSB_APRX$ssbssbmsy_w[1,],TOTAL_B$uumsy_w[1,],col='dark grey')
segs(TOTAL_SSB_APRX$ssbssbmsy_w[1,],TOTAL_SSB_APRX$ssbssbmsy_w[2,],TOTAL_B$uumsy_w[1,],TOTAL_B$uumsy_w[2,])
mtext('Weighted Mean',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('g',adj=0.05,line=0)
plot(TOTAL_B$uumsy_med[1,],TOTAL_SSB_APRX$ssbssbmsy_med[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); segg()
lines(TOTAL_SSB_APRX$ssbssbmsy_med[1,],TOTAL_B$uumsy_med[1,],col='dark grey')
segs(TOTAL_SSB_APRX$ssbssbmsy_med[1,],TOTAL_SSB_APRX$ssbssbmsy_med[2,],TOTAL_B$uumsy_med[1,],TOTAL_B$uumsy_med[2,])
mtext('Median',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('h',adj=0.05,line=0)
plot(TOTAL_B$uumsy_tc[1,],TOTAL_SSB_APRX$ssbssbmsy_tc[1,],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha); 		segg()
lines(TOTAL_SSB_APRX$ssbssbmsy_tc[1,],TOTAL_B$uumsy_tc[1,],col='dark grey')
segs(TOTAL_SSB_APRX$ssbssbmsy_tc[1,],TOTAL_SSB_APRX$ssbssbmsy_tc[2,],TOTAL_B$uumsy_tc[1,],TOTAL_B$uumsy_tc[2,])
mtext('Mean Catch',adj=1,cex=1,line=1); mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('i',adj=0.05,line=0)
plot(uvu$dlm.geomean,ssbvssbaprx$dlm.geomean[1:n],ylim=c(0,2),xlim=c(0,2),cex=0.1,type='n',bty='n',xlab='',ylab='')
rects(alpha=alpha)
lines(ssbvssbaprx$dlm.geomean[1:n],uvu$dlm.geomean,col='dark grey')
segg()
segs(ssbvssbaprx$dlm.geomean,ssbvssbaprx$dlm.geomean-ssbvssbaprx$dlm.lower,uvu$dlm.geomean,uvu$dlm.geomean-uvu$dlm.lower)
mtext('State Space Model',adj=1,cex=1,line=1);mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); 		mtext('Historical Biomass Target',adj=1,cex=0.6,line=0); mtext('j',adj=0.05,line=0)
mtext(side=2,outer=TRUE,expression('U/U'['MSY']),cex=1.3,line=1.5)
mtext(side=1,outer=TRUE,expression('SSB/SSB'['MSY']),cex=1.3,line=1.5)
